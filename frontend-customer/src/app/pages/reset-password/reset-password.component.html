<div class="reset-password-container">
  <div class="reset-card">
    <!-- Header -->
    <div class="reset-header text-center mb-4">
      <h2 class="reset-title">
        <i class="fas fa-key me-2"></i>
        Reset Your Password
      </h2>
      <p class="text-muted">Enter your new password below</p>
    </div>

    <!-- Token/Email Warning -->
    <div *ngIf="!token || !email" class="alert alert-warning">
      <i class="fas fa-exclamation-triangle me-2"></i>
      {{errorMessage}}
      <button class="btn btn-sm btn-outline-warning ms-2" (click)="requestNewLink()">
        Request New Link
      </button>
    </div>

    <!-- Reset Form -->
    <form *ngIf="token && email" [formGroup]="resetForm" (ngSubmit)="onSubmit()">
      
      <!-- New Password -->
      <div class="form-group mb-3">
        <label for="newPassword" class="form-label">New Password</label>
        <div class="input-group">
          <input 
            [type]="hideNewPassword ? 'password' : 'text'" 
            class="form-control" 
            id="newPassword"
            formControlName="newPassword"
            placeholder="Enter new password"
            [class.is-invalid]="resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched">
          <button class="btn btn-outline-secondary" type="button" (click)="hideNewPassword = !hideNewPassword">
            <i class="fas" [class.fa-eye]="hideNewPassword" [class.fa-eye-slash]="!hideNewPassword"></i>
          </button>
        </div>
        <div *ngIf="resetForm.get('newPassword')?.touched">
          <small class="text-danger" *ngIf="resetForm.get('newPassword')?.hasError('required')">
            Password is required
          </small>
          <small class="text-danger" *ngIf="resetForm.get('newPassword')?.hasError('minlength')">
            Password must be at least 6 characters
          </small>
        </div>
      </div>

      <!-- Confirm Password -->
      <div class="form-group mb-4">
        <label for="confirmPassword" class="form-label">Confirm Password</label>
        <div class="input-group">
          <input 
            [type]="hideConfirmPassword ? 'password' : 'text'" 
            class="form-control" 
            id="confirmPassword"
            formControlName="confirmPassword"
            placeholder="Confirm new password"
            [class.is-invalid]="resetForm.get('confirmPassword')?.invalid && resetForm.get('confirmPassword')?.touched">
          <button class="btn btn-outline-secondary" type="button" (click)="hideConfirmPassword = !hideConfirmPassword">
            <i class="fas" [class.fa-eye]="hideConfirmPassword" [class.fa-eye-slash]="!hideConfirmPassword"></i>
          </button>
        </div>
        <div *ngIf="resetForm.get('confirmPassword')?.touched">
          <small class="text-danger" *ngIf="resetForm.get('confirmPassword')?.hasError('required')">
            Please confirm your password
          </small>
          <small class="text-danger" *ngIf="resetForm.get('confirmPassword')?.hasError('passwordMismatch')">
            Passwords do not match
          </small>
        </div>
      </div>

      <!-- Submit Button -->
      <button 
        type="submit" 
        class="btn btn-primary w-100 py-2 mb-3"
        [disabled]="resetForm.invalid || loading">
        <span *ngIf="!loading">
          <i class="fas fa-save me-2"></i>
          Reset Password
        </span>
        <span *ngIf="loading">
          <i class="fas fa-spinner fa-spin me-2"></i>
          Resetting...
        </span>
      </button>

      <!-- Success Message -->
      <div *ngIf="message" class="alert alert-success">
        <i class="fas fa-check-circle me-2"></i>
        {{ message }}
        <div class="mt-2">
          <small>Redirecting to login page...</small>
        </div>
      </div>

      <!-- Error Message -->
      <div *ngIf="errorMessage" class="alert alert-danger">
        <i class="fas fa-exclamation-triangle me-2"></i>
        {{ errorMessage }}
      </div>
    </form>

    <!-- Back to Login -->
    <div class="text-center mt-4">
      <p class="text-muted">
        Remember your password?
        <a routerLink="/login" class="text-decoration-none">Back to Login</a>
      </p>
    </div>
  </div>
</div>